<!DOCTYPE html>
<html>
  <head>
    <style>

      .card {
        border: thin solid black;
        border-radius: 16px;
        height: 150px;
        width: 90px;
        margin-bottom: 16px;
        display: grid;
        align-items: center;
        justify-items: center;
        background-color: rgb(209, 159, 159);
        color: rgb(0, 0, 0);
      }

      .game-area {
        display: grid;
        grid-template-columns: 1fr 1fr;
        position:absolute;
        top:0; left:0; right:0; bottom:0; 
        margin:auto;
      }

      .card-area {
        display: grid;
        grid-template-columns: 1fr 1fr;
        margin-inline: 10px;
      }

      .hidden {
        visibility: hidden;
      }

      .button-area {
        display: grid;
        grid-column: 1fr;
      }

      .hit-check-button {
        display: grid;
        grid-template: 1fr 1fr;
      }
      
    </style>
  </head>







  <body>

    
    <div class="game-area">

      <div class="character">
        <div class="title">Dealer</div>
        <div class="card-area">
          <div id="dealer-0" class="card">Card</div>
          <div id="dealer-1" class="card"></div>
        </div>
      </div>

      <div class="character">
        <div class="title">Player</div>
        <div class="card-area">
          <div id="player-0" class="card"></div>
          <div id="player-1" class="card"></div>
          <div id="player-2" class="card" class="hidden"></div> <!--how do you hid css, the cards in the begining?-->
          <div id="player-3" class="card" class="hidden"></div>
        </div>
      </div>

    <div>Status: <span id="statusId"></span></div>

    <div class="button-area">
      <button onclick="startGame()" class="hidden" id="dealCardsId">Deal cards</button>
      <div class="hit-check-button">
        <button onclick="hitOrCheck()" id="hitPlayerId">Hit</button>
        <button onclick="check()" id="checkPlayerId">Check</button>
      </div>
    </div>
    

    </div>

  </body>










  <script>

    var deck
    var dealerCards
    var playerCards
    
    var gameActive = true

    var statusId = document.getElementById("statusId").innerHTML



    function updateHTML(message) {
      document.getElementById("statusId").innerHTML = message
      document.getElementById("dealCardsId").classList.toggle("hidden")
    }



    function toggleButtons () {
      document.getElementById("dealCardsId").classList.toggle("hidden")
      document.getElementById("hitPlayerId").classList.toggle("hidden")
      document.getElementById("checkPlayerId").classList.toggle("hidden")
      console.log("toggle")
    }





    function buildDeck () {
      var newDeck = []
      var suits = ['heart', 'spade', 'diamond', 'club']
      var values = [1,2,3,4,5,6,7,8,9,10,11,12,13]

      suits.forEach((suit) => {
        values.forEach((value) => {

          var card = {
            suit: suit,
            value: value,
          }

          newDeck.push(card)

        })
      })

      return newDeck
    }
    
    function shuffle (deck) {
      // we declare 2 parameters here even though we won't use them since we are using Math.random() to deteremine 1 or -1 instead of these values
      var sortFunc = (card1, card2) => { 
        var result

        if ( Math.random() > .5 ) {
          result = 1
        } else {
          result = -1
        }

        return result
      }

      deck.sort(sortFunc)

      return deck
    }




    function get2Cards () {
      var card1 = deck.shift()
      var card2 = deck.shift()

      var cards = [card1, card2]

      return cards
    }





    function displayCards () {
      document.getElementById("statusId").innerHTML = "Hit or Check?"

      var dealerCard0 = dealerCards[0]
      //document.getElementById("dealer-0").innerHTML = dealerCard0.value + " of " + dealerCard0.suit

      var dealerCard1 = dealerCards[1]
      document.getElementById("dealer-1").innerHTML = dealerCard1.value + " of " + dealerCard1.suit

      var playerCard0 = playerCards[0]
      document.getElementById("player-0").innerHTML = playerCard0.value + " of " + playerCard0.suit

      var playerCard1 = playerCards[1]
      document.getElementById("player-1").innerHTML = playerCard1.value + " of " + playerCard1.suit

      if (playerCards.length === 3) {
        var playerCard2 = playerCards[2]
      document.getElementById("player-2").innerHTML = playerCard2.value + " of " + playerCard2.suit
      }
      
      if (playerCards.length === 4 ) {
        var playerCard3 = playerCards[3]
      document.getElementById("player-3").innerHTML = playerCard3.value + " of " + playerCard3.suit
      }

    }





    function declareWinner () {
      var dealerTotal = 0
      var playerTotal = 0

      dealerCards.forEach((card) => {
        dealerTotal = dealerTotal + card.value
      })

      playerCards.forEach((card) => {
        playerTotal = playerTotal + card.value
      })

      var message
      if (playerTotal > dealerTotal && playerTotal < 22) {
        message = "Cool! Player beats dealer, " + playerTotal + " to " + dealerTotal + "."
      } else if (playerTotal > 21) {
        message = "Bummer. You busted. Dealer won, " + dealerTotal + " to " + playerTotal + "."
      } else {
        message = "Bummer. Dealer won, " + dealerTotal + " to " + playerTotal + "."
      }

      updateHTML(message)
    }

    function hitOrCheck () {
      // if (document.getElementById("hitPlayerId").onclick) {  // What is wrong with this conditional??
        var newCard = deck.shift()
        playerCards.push(newCard)

        displayCards()
        
      } //else {
    //     declareWinner()
    //   }
    // }

    function check () {
      toggleButtons()  // why does the deal cards button not toggle back on after clicking check?
      declareWinner()
    }



    function startGame () {
      toggleButtons()

      var newDeck = buildDeck()
      var shuffledNewDeck = shuffle(newDeck)
      deck = shuffledNewDeck

      dealerCards = get2Cards()
      playerCards = get2Cards()
      displayCards()
      //setTimeout(declareWinner, 2000)
    }

    toggleButtons()

  </script>
</html>